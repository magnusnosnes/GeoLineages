---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```

# GeoLineages

<!-- badges: start -->
<!-- badges: end -->

The goal of GeoLineages is to provide a set of functions that are used to analyse the outputs from ancestral state analyses.

## Installation

You can install the latest version of GeoLineages this repository using 

``` r
devtools::github_install("magnusnosnes/GeoLineages")
```

## Example

This is a basic example which shows you how to solve a common problem:

```{r example}
library(GeoLineages)
## basic example code
```

What is special about using `README.Rmd` instead of just `README.md`? You can include R chunks like so:

```{r,fig.width=10,fig.height=7}
set.seed(400)
library(phytools)
library(ape)
library(phangorn)
library(BactDating)

#Simulate data from Norway and rest of the world
#set.seed(400)
tree_test = simdatedtree(nsam=10, dateroot=2000)
tree_test = ladderize(tree_test)
Q=matrix(c(0.5,0.5,0.5,0.5), nrow=2,ncol=2, byrow=F)
loc = c("Norway", "Norway","Norway","RoW", "RoW", "Norway", "Norway", "RoW", "RoW", "RoW")
names(loc) = tree_test$tip.label
mapped_Q = sim.history(tree_test, Q,nsim=10)
colnames(Q)=c("Norway","RoW")

fit1 = ace(x=loc, phy= tree_test, type="discrete", mod="ARD")
plot.phylo(tree_test,lwd=2,label.offset = 0.15, mar=c(0.2,0.2,0.2,0.2))
axisPhylo(root.time=2000, backward=F)
nodelabels(pie=fit1$lik.anc,cex=0.7,piecol=c("Red","Blue"))
tips = to.matrix(loc,seq=c("Norway", "RoW"))
tiplabels(pie=tips, cex=0.7,piecol=c("Red","Blue"))

count_import_export_ace(tree_test, ace_nodes=fit1$lik.anc,
                        ace_tips = to.matrix(loc, seq=c("Norway", "RoW")), start_time=2000)
```

